getwd()
datTraits = read.csv('datTraits', stringsAsFactors = FALSE, header = TRUE, sep = "\t");
View(datTraits)
datTraits$Sex = gsub(1, "Female", datTraits)
datTraits$Sex = gsub(1, "Female", datTraits$Sex)
datTraits$Sex = gsub(0, "Male", datTraits$Sex)
datTraits$Age = ""
datTraits$Age = gsub(1, "4mon", datTraits$X4month)
datTraits$Age = gsub(1, "8mon", datTraits$X8month)
datTraits$Age = gsub(1, "4mon", datTraits$X4month)
datTraits$Age[datTraits$X8month == 1] = "8mon"
datTraits$Age[datTraits$X12month == 1] = "12mon"
datTraits$Age[datTraits$X18month == 1] = "18mon"
datTraits$Tissue = gsub(1, "Hippocampus", datTraits$Tissue)
datTraits$Tissue = gsub(0, "Cortex", datTraits$Tissue)
datTraits$Genotype = ""
datTraits$Genotype[datTraits$X5xFADHEMI == 1] = "5xFADHEMI"
datTraits$Genotype[datTraits$X5xFADWT == 1] = "5xFADWT"
datTraits$X4month = NULL
datTraits$X8month = NULL
datTraits$X12month = NULL
datTraits$X18month = NULL
datTraits$X5xFADHEMI = NULL
datTraits$X5xFADWT = NULL
datTraits = datTraits[, c(3,2,1,4)]
write.table(datTraits, file = 'metaData', row.names = FALSE, quote = F, sep = "\t")
expressionList = read.table('expressionList_sorted', header = TRUE);
View(expressionList)
## Prepare and clean data
#Remove rows with less than 1 TPM
expressionList = expressionList[rowMaxs(expressionList[,-c(1)], na.rm = TRUE)>1,]
datExpr0 = as.data.frame(t(expressionList[,-c(1)]));
names(datExpr0) = expressionList$gene_id
rownames(datExpr0) = names(expressionList)[-c(1)];
### Create data Trait by data exp
datTraits = matrix(0, length(row.names(datExpr)), 4)
colnames(datTraits) = c("Age",	"Tissue",	"Sex",	"Genotype")
### Create data Trait by data exp
datTraits = matrix(0, length(row.names(datExpr)), 4)
### Create data Trait by data exp
datTraits = matrix(0, length(row.names(datExpr0)), 4)
colnames(datTraits) = c("Age",	"Tissue",	"Sex",	"Genotype")
datTraits = as.data.frame(datTraits)
write.table(datTraits, file = 'metaData', row.names = FALSE, quote = F, sep = "\t")
View(datTraits)
for (i in c(1:length(row.names(datExpr)))) {
tmp = strsplit(row.names(datExpr)[i], "_")[[1]]
print(tmp)
if (tmp[1] == "X4mo"){
datTraits$Age[i] = "4mon"
}
if (tmp[1] == "X8mo"){
datTraits$Age[i] = "8mon"
}
if (tmp[1] == "X12mo"){
datTraits$Age[i] = "12mon"
}
if (tmp[1] == "X18mo"){
datTraits$Age[i] = "18mon"
}
if (tmp[3] == "F"){
datTraits$Sex[i] = "Female"
} else {
datTraits$Sex[i] = "Male"
}
if (tmp[4] == "5xFADHEMI"){
datTraits$Genotype[i] = "5xFADHEMI"
}
if (tmp[4] == "5xFADWT"){
datTraits$Genotype[i] = "5xFADWT"
}
}
for (i in c(1:length(row.names(datExpr0)))) {
tmp = strsplit(row.names(datExpr0)[i], "_")[[1]]
print(tmp)
if (tmp[1] == "X4mo"){
datTraits$Age[i] = "4mon"
}
if (tmp[1] == "X8mo"){
datTraits$Age[i] = "8mon"
}
if (tmp[1] == "X12mo"){
datTraits$Age[i] = "12mon"
}
if (tmp[1] == "X18mo"){
datTraits$Age[i] = "18mon"
}
if (tmp[3] == "F"){
datTraits$Sex[i] = "Female"
} else {
datTraits$Sex[i] = "Male"
}
if (tmp[4] == "5xFADHEMI"){
datTraits$Genotype[i] = "5xFADHEMI"
}
if (tmp[4] == "5xFADWT"){
datTraits$Genotype[i] = "5xFADWT"
}
}
write.table(datTraits, file = 'metaData', row.names = FALSE, quote = F, sep = "\t")
expressionList = read.table('expressionList_sorted', header = TRUE);
datExpr0 = as.data.frame(t(expressionList[,-c(1)]));
names(datExpr0) = expressionList$gene_id
rownames(datExpr0) = names(expressionList)[-c(1)];
View(datExpr0)
### Create data Trait by data exp
datTraits = matrix(0, length(row.names(datExpr0)), 4)
colnames(datTraits) = c("Age",	"Tissue",	"Sex",	"Genotype")
datTraits = as.data.frame(datTraits)
for (i in c(1:length(row.names(datExpr0)))) {
tmp = strsplit(row.names(datExpr0)[i], "_")[[1]]
print(tmp)
if (tmp[1] == "X4mo"){
datTraits$Age[i] = "4mon"
}
if (tmp[1] == "X8mo"){
datTraits$Age[i] = "8mon"
}
if (tmp[1] == "X12mo"){
datTraits$Age[i] = "12mon"
}
if (tmp[1] == "X18mo"){
datTraits$Age[i] = "18mon"
}
if (tmp[2] == "cortex"){
datTraits$Tissue[i] = "Cortex"
} else {
datTraits$Tissue[i] = "Hippocampus"
}
if (tmp[3] == "F"){
datTraits$Sex[i] = "Female"
} else {
datTraits$Sex[i] = "Male"
}
if (tmp[4] == "5xFADHEMI"){
datTraits$Genotype[i] = "5xFADHEMI"
}
if (tmp[4] == "5xFADWT"){
datTraits$Genotype[i] = "5xFADWT"
}
}
write.table(datTraits, file = 'metaData', row.names = FALSE, quote = F, sep = "\t")
expressionList = read.csv('expressionList_3xTgAD_hipp_female', header = TRUE);
